<script>
document.addEventListener('DOMContentLoaded', () => {
    const gallery = document.getElementById('gallery');
    const lightbox = document.getElementById('lightbox');
    const lightboxImage = document.getElementById('lightbox-image');
    const lightboxCaption = document.getElementById('lightbox-caption');
    const lightboxCloseButton = document.getElementById('lightbox-close-button');

    if (!gallery || !lightbox) return;

    // Open lightbox when an image inside the gallery is clicked (delegation)
    gallery.addEventListener('click', (e) => {
        const img = e.target.closest('img');
        if (!img || !gallery.contains(img)) return;

        lightboxImage.src = img.src;
        lightboxImage.alt = img.alt || '';
        lightboxCaption.textContent = img.alt || '';
        lightbox.classList.add('active');
        document.body.style.overflow = 'hidden'; // prevent background scroll
    });

    function closeLightbox() {
        lightbox.classList.remove('active');
        document.body.style.overflow = '';
        // clear src to stop any potential audio/video or free memory
        lightboxImage.src = '';
    }

    // Close handlers
    lightboxCloseButton.addEventListener('click', closeLightbox);
    lightbox.addEventListener('click', (e) => {
        if (e.target === lightbox) closeLightbox(); // click outside content
    });
    document.addEventListener('keydown', (e) => {
        if (e.key === 'Escape') closeLightbox();
    });
});
</script>
